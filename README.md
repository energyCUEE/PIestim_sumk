# Large width penalization for neural network-based prediction interval estimation
Forecasting accuracy in highly uncertain environments is challenging due to the stochastic nature of such systems. Deterministic forecasting, which provides only point estimates, is insufficient to capture potential outcomes. Therefore, probabilistic forecasting has gained significant attention due to its ability to quantify uncertainty, where one of the approaches is to express it as a prediction interval (PI), that explicitly shows upper and lower bounds of predictions associated with a confidence level. High-quality PI is characterized by a high PI coverage probability (PICP) and a narrow PI width. In many real-world applications, the PI width is generally used in risk management to prepare resources that improve reliability and effectively manage uncertainty. A wider PI width results in higher costs for backup resources as decision-making processes generally focus on the worst-case scenarios arising with large PI widths under extreme conditions. This study aims to reduce the large PI width from the PI estimation method by proposing a new PI loss function that penalizes the average of the large PI widths more heavily. Additionally, the proposed formulation is compatible with gradient-based algorithms, the standard approach to training neural networks (NNs), and integrating state-of-the-art NNs and existing deep learning techniques. Experiments with the synthetic dataset reveal that our formulation significantly reduces the large PI width while effectively maintaining the PICP to achieve the desired probability. The practical implementation of our proposed loss function is demonstrated in solar irradiance forecasting, highlighting its effectiveness in minimizing the large PI width in data with high uncertainty and showcasing its compatibility with more complex neural network models. Therefore, reducing large PI widths from our method can lead to significant cost savings by over-allocation of reserve resources.

|-- demo.ipynb
|-- utils
    |-- formulations.py
    |-- networks.py
    |-- trainer.py
|-- experiment
    |-- benchmark
        |-- exp_benchmark_sin_qrf.py
        |-- exp_benchmark_polynomial_qr.py
        |-- exp_benchmark_multivariate_mve.py
        |-- exp_benchmark_polynomial_qrf.py
        |-- exp_benchmark_polynomial_mve.py
        |-- exp_benchmark_sin_mve.py
        |-- exp_benchmark_sin_qr.py
        |-- exp_benchmark_gaussian_dic.py
        |-- exp_benchmark_multivariate_qrf.py
        |-- exp_benchmark_multivariate_dic.py
        |-- exp_benchmark_gaussian_qrf.py
        |-- exp_benchmark_gaussian_qr.py
        |-- exp_benchmark_multivariate_qr.py
        |-- exp_benchmark_gaussian_mve.py
        |-- exp_benchmark_sin_dic.py
        |-- exp_benchmark_polynomial_dic.py
    |-- input_data
        |-- dgp_polynomial_100trials.pkl
        |-- .DS_Store
        |-- dgp_gaussian_100trials.pkl
        |-- dgp_multivariate_100trials.pkl
        |-- dgp_sin_100trials.pkl
    |-- experimental_result
        |-- mve_performance_dgpsin_done.pkl
        |-- dic_performance_dgpgaussian_done.pkl
        |-- qd_tradeoff_dgpmultivariate_done.pkl
        |-- qd_tradeoff_dgpsin_done.pkl
        |-- cwcquan_tradeoff_dgppolynomial_done.pkl
        |-- cwcshri_tradeoff_dgppolynomial_done.pkl
        |-- qrf_performance_dgppolynomial_done.pkl
        |-- cwcquan_tradeoff_dgpgaussian_done.pkl
        |-- sumk_tradeoff_dgpmultivariate_done.pkl
        |-- mve_performance_dgpgaussian_done.pkl
        |-- cwcli_tradeoff_dgpgaussian_done.pkl
        |-- dic_performance_dgppolynomial_done.pkl
        |-- qr_performance_dgpgaussian_done.pkl
        |-- cwcli_tradeoff_dgpmultivariate_done.pkl
        |-- sumk_tradeoff_dgpsin_done.pkl
        |-- cwcquan_tradeoff_dgpmultivariate_done.pkl
        |-- qr_performance_dgpsin_done.pkl
        |-- qrf_performance_dgpsin_done.pkl
        |-- mve_performance_dgppolynomial_done.pkl
        |-- qr_performance_dgpmultivariate_done.pkl
        |-- cwcshri_tradeoff_dgpgaussian_done.pkl
        |-- qd_tradeoff_dgpgaussian_done.pkl
        |-- sumk_tradeoff_dgpgaussian_done.pkl
        |-- cwcshri_tradeoff_dgpsin_done.pkl
        |-- cwcli_tradeoff_dgppolynomial_done.pkl
        |-- qrf_performance_dgpgaussian_done.pkl
        |-- qrf_performance_dgpmultivariate_done.pkl
        |-- qd_tradeoff_dgppolynomial_done.pkl
        |-- cwcli_tradeoff_dgpsin_done.pkl
        |-- dic_performance_dgpmultivariate_done.pkl
        |-- dic_performance_dgpsin_done.pkl
        |-- sumk_tradeoff_dgppolynomial_done.pkl
        |-- mve_performance_dgpmultivariate_done.pkl
        |-- cwcquan_tradeoff_dgpsin_done.pkl
        |-- cwcshri_tradeoff_dgpmultivariate_done.pkl
        |-- qr_performance_dgppolynomial_done.pkl
    |-- pi_characteristics
        |-- exp_tradeoff_polynomial_cwcli.py
        |-- exp_tradeoff_multivariate_qd.py
        |-- exp_tradeoff_sin_qd.py
        |-- .DS_Store
        |-- exp_tradeoff_sin_sumk.py
        |-- exp_tradeoff_multivariate_cwcquan.py
        |-- exp_tradeoff_multivariate_cwcshri.py
        |-- exp_tradeoff_polynomial_qd.py
        |-- exp_tradeoff_polynomial_sumk.py
        |-- exp_tradeoff_polynomial_cwcquan.py
        |-- exp_tradeoff_sin_cwcquan.py
        |-- exp_tradeoff_sin_cwcli.py
        |-- exp_tradeoff_multivariate_cwcli.py
        |-- exp_tradeoff_gaussian_qd.py
        |-- exp_tradeoff_gaussian_cwcquan.py
        |-- exp_tradeoff_gaussian_sumk.py
        |-- exp_tradeoff_multivariate_sumk.py
        |-- exp_tradeoff_polynomial_cwcshri.py
        |-- exp_tradeoff_gaussian_cwcli.py
        |-- exp_tradeoff_gaussian_cwcshri.py
        |-- exp_tradeoff_sin_cwcshri.py
    |-- hyperparameter
        |-- hyperparam_cwcli_dgppolynomial.json
        |-- hyperparam_cwcli_dgpgaussian.json
        |-- hyperparam_mve_dgpall.json
        |-- hyperparam_sumk_dgpsin.json
        |-- hyperparam_qrf_dgpsin.json
        |-- hyperparam_qrf_dgpgaussian.json
        |-- hyperparam_qrf_dgppolynomial.json
        |-- hyperparam_qr_dgpall.json
        |-- hyperparam_cwcli_dgpsin.json
        |-- hyperparam_qd_dgpsin.json
        |-- hyperparam_cwcquan_dgpsin.json
        |-- hyperparam_qrf_dgpmultivariate.json
        |-- hyperparam_cwcli_dgpmultivariate.json
        |-- hyperparam_cwcshri_dgpsin.json
|-- paper_figure
    |-- visualization.ipynb
    |-- saved_figures
        |-- piresult_dgpmultivariate.pdf
        |-- hist_piwidth_dgpgaussian.pdf
        |-- tradeoffcurve_dgpmultivariate.pdf
        |-- piresult_dgpgaussian.pdf
        |-- tradeoffcurve_dgpgaussian.pdf
        |-- hist_piwidth_dgpmultivariate.pdf
        |-- tradeoffcurve_dgppolynomial.pdf
        |-- piresult_dgpsin.pdf
        |-- tradeoffcurve_dgpsin.pdf
        |-- hist_piwidth_dgppolynomial.pdf
        |-- hist_piwidth_dgpsin.pdf
        |-- piresult_dgppolynomial.pdf
    |-- plotcode.py
